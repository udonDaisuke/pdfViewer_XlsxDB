# PDF Viewer x XLSX database
https://udondaisuke.github.io/pdfViewer_XlsxDB/
## 概要
- シングルページのpdfファイルを連続したページとして表示する仕組み
- ページ順の情報はXLSXにまとめられており、リストの上から順にページ送りが可能
  - `file`: 参照先フォルダjs内に記載のフォルダ配下にあるpdfのファイル名（表示するファイル）
  - `section` `tag`: ページのタイトルや見出しに相当する情報とカテゴリ
  - `note`: pdfの表示画面下に表示したい補足情報
- オンプレ環境での動作を想定しており、ユーザーが作ったドキュメントをフォルダに格納し、エクセルに情報をためておく古めかしい管理スタイルを想定

![image](https://github.com/user-attachments/assets/2e3fd8c0-264e-4c04-bfd0-809a28ab74f5)

## 画面と機能
- pdf表示画面(ツールバーは非表示、右クリックで保存も直接できない仕様。※やろうと思えばできる)
- 画面送りボタン4種
- pdfのファイル名以外のテキスト情報をついかで表示してみた。ページを送ると表示情報も変化する

> [!note]
> 1. 表示されるテキストはchatGPTで適当に出力したものです。
> 1. pdfはpptxのテンプレートとフリー素材を適当に張り付けて作成内容は特に意味はない
  
![image](https://github.com/user-attachments/assets/ab406f55-bdaa-4467-ac8d-71fd8efc08fc)

## 収穫
- JSの復習と機能の確認ができた
  - クラスを使った実装（基本をさらった程度。継承とかはしてない）
  - 配列・ループ・条件分岐復習
  - 正規表現（onsubmit内の埋め込みで使ってる）`split` `replace`で使用
  - ローカル環境のエクセルの情報取得(fetchして非同期で処理しないといけなかった)
  - iframeでどこまでやれるのか確認zoomとかの調整がうまくいかないことが多かった。iframe枠ぴったりにはなかなかできない
- 大容量のpdfは読み込みが遅い、バラのpdfを都度読み込む方式だとどうか？を調べられた
  - 読み込み自体は早い。iframeが表示するまでに少し時間がかかっている。（フェードするのでストレスはそこまでない）
  - 前後ページを同時読み込んで、いつでも表示できるようにしておくと良いかも（やらないけど）
  - 一つだけ表示する方式にしたが、上から順に並べる方式でも作れる。その場合loading="lazy"を忘れないように。
- 非システム系の現場向けなら、エクセルファイルをサーバーサイドの代わりに使うのもアリかもしれん。現場の人SQLなんてわかんないもん。（当然当然リスクはあるけど

